[tox]
envlist = py27, py35, py36, flake8, docs, docs-upload, download-wheels, upload-wheels
skipsdist = True
whitelist_externals = make


[flake8]
ignore = E12, W503
max-line-length = 120
show-source = True
builtins = get_ipython


[pytest]
addopts = -rfxEXs --durations=20


[testenv]
recreate = True
deps = numpy==1.11.3
	   scipy==0.18.1
	   .[test]
setenv = FT_HOME={env:FT_HOME:}
		 WR_HOME={env:WR_HOME:}
		 VOWPAL_WABBIT_PATH={env:VOWPAL_WABBIT_PATH:}
		 DTM_PATH={env:DTM_PATH:}
		 MALLET_HOME={env:MALLET_HOME:}

commands = pytest gensim/test


[testenv:flake8]
recreate = True
deps = flake8

commands = flake8 gensim/


[testenv:docs]
recreate = True
whitelist_externals = make
deps = .[docs]
changedir = docs/src

commands = make clean html


[testenv:docs-upload]
recreate = True
whitelist_externals = make
deps = .[docs]
changedir = docs/src

commands = make clean html upload


[testenv:download-wheels]
deps = wheelhouse_uploader
whitelist_externals = rm
recreate = True

commands = rm -rf dist/
		   python setup.py sdist fetch_artifacts


[testenv:upload-wheels]
deps = wheelhouse_uploader

commands = python setup.py register sdist upload
